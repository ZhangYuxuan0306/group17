{% extends "base.html" %}

{% block content %}
<section class="card">
    <h1>{{ variant_meta.label or ("æ£€ç´¢å™¨ï¼š" + variant) }}</h1>
    <p>{{ variant_meta.description or "ä½“éªŒè¯¥æ£€ç´¢/é‡æ’ç­–ç•¥çš„é—®ç­”è¡¨ç°ã€‚" }}</p>
</section>

<section class="card">
    <h2>ğŸ“ æé—®</h2>
    <form id="qa-form">
        <label for="qa-query">é—®é¢˜</label>
        <textarea id="qa-query" name="query" rows="4" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." required></textarea>

        <label for="qa-topk">Top-K</label>
        <input type="number" id="qa-topk" name="top_k" value="5" min="1" max="20">

        <button type="submit" id="qa-submit">å‘é€è¯·æ±‚</button>
    </form>
</section>

<section class="card">
    <h2>ğŸ’¡ å›ç­”</h2>
    <div id="qa-answer" class="answer-placeholder">ç­‰å¾…æé—®...</div>
    <div id="qa-citations"></div>
</section>

<section class="card">
    <h2>ğŸ§ª RAGAS è¯„ä¼°</h2>
    <p class="hint">å…ˆå®Œæˆé—®ç­”ï¼Œå†ç‚¹å‡»æŒ‰é’®è§¦å‘è¯„ä¼°ã€‚å¯é€‰åœ°æä¾›å‚è€ƒç­”æ¡ˆä»¥è®¡ç®—ç›¸å…³æ€§/å¬å›ã€‚</p>
    <textarea
        id="qa-reference"
        name="reference"
        rows="3"
        placeholder="å¦‚éœ€å¯¹ç”Ÿæˆç»“æœè¿›è¡Œç›¸å…³æ€§/å¬å›è¯„ä¼°ï¼Œå¯åœ¨æ­¤ç²˜è´´å‚è€ƒç­”æ¡ˆã€‚ç•™ç©ºåˆ™ä½¿ç”¨ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆã€‚"
    ></textarea>
    <div class="evaluate-actions">
        <button id="qa-run-eval" disabled>è¿è¡Œ RAGAS è¯„ä¼°</button>
    </div>
    <div id="qa-evaluation" class="evaluation-placeholder">
        ç”Ÿæˆå›ç­”åå¯æ‰§è¡Œè¯„ä¼°ã€‚
    </div>
</section>

<section class="card">
    <h2>ğŸ“Š åœ¨çº¿æŒ‡æ ‡</h2>
    <table>
        <thead>
            <tr>
                <th>æ—¶é—´</th>
                <th>æŸ¥è¯¢</th>
                <th>æ€»å»¶è¿Ÿ(ms)</th>
                <th>æ£€ç´¢(ms)</th>
                <th>ç”Ÿæˆ(ms)</th>
                <th>Top-k</th>
            </tr>
        </thead>
        <tbody id="qa-metrics-body">
            <tr>
                <td colspan="6" class="table-empty">æš‚æ— æ•°æ®</td>
            </tr>
        </tbody>
    </table>
</section>

<script>
window.QA_CONFIG = {
    variant: "{{ variant }}",
    askUrl: "{{ url_for('ask_variant', variant=variant) }}",
    metricsUrl: "{{ url_for('metrics_variant', variant=variant) }}",
    variantLabel: "{{ variant_meta.label or variant }}",
    evaluateUrl: "{{ url_for('ragas_evaluate') }}",
};
</script>
<script src="{{ url_for('static', path='qa.js') }}"></script>
{% endblock %}
